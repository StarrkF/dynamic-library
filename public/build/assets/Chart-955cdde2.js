import{u as M}from"./config-df2164b1.js";import{_ as N}from"./BaseSelect-6250de75.js";import{n as D,e as w,q as U,s as A,t as L,C as S,B as R,L as $,P as z,x as E,o as C,c as G,d as W,a as Y,i as O,j as _}from"./app-51e1db9d.js";import{_ as h,Y as V,P as k,e as T,Z as m}from"./reactivity.esm-bundler-9db843ea.js";const j={data:{type:Object,required:!0},options:{type:Object,default:()=>({})},plugins:{type:Array,default:()=>[]},datasetIdKey:{type:String,default:"label"},updateMode:{type:String,default:void 0}},Z={type:{type:String,required:!0},...j},F=E[0]==="2"?(t,e)=>Object.assign(t,{attrs:e}):(t,e)=>Object.assign(t,e);function y(t){return T(t)?k(t):t}function H(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:t;return T(e)?new Proxy(t,{}):t}function J(t,e){const s=t.options;s&&e&&Object.assign(s,e)}function q(t,e){t.labels=e}function I(t,e,s){const l=[];t.datasets=e.map(a=>{const n=t.datasets.find(c=>c[s]===a[s]);return!n||!a.data||l.includes(n)?{...a}:(l.push(n),Object.assign(n,a),n)})}function Q(t,e){const s={labels:[],datasets:[]};return q(s,t.labels),I(s,t.datasets,e),s}const X=D({props:Z,setup(t,e){let{expose:s}=e;const l=h(null),a=V(null);s({chart:a});const n=()=>{if(!l.value)return;const{type:r,data:f,options:i,plugins:u,datasetIdKey:d}=t,b=Q(f,d),p=H(b,f);a.value=new S(l.value,{type:r,data:p,options:{...i},plugins:u})},c=()=>{const r=k(a.value);r&&(r.destroy(),a.value=null)},o=r=>{r.update(t.updateMode)};return w(n),U(c),A([()=>t.options,()=>t.data],(r,f)=>{let[i,u]=r,[d,b]=f;const p=k(a.value);if(!p)return;let g=!1;if(i){const v=y(i),x=y(d);v&&v!==x&&(J(p,v),g=!0)}if(u){const v=y(u.labels),x=y(b.labels),P=y(u.datasets),K=y(b.datasets);v!==x&&(q(p.config.data,v),g=!0),P&&P!==K&&(I(p.config.data,P,t.datasetIdKey),g=!0)}g&&o(p)},{deep:!0}),()=>L("canvas",{ref:l})}});function B(t,e){return S.register(e),D({props:j,setup(s,l){let{expose:a}=l;const n=V(null),c=o=>{n.value=o==null?void 0:o.chart};return a({chart:n}),()=>L(X,F({ref:c},{type:t,...s}))}})}const tt=B("bar",R),et=B("line",$),at=B("pie",z),lt={__name:"Chart",setup(t){const{index:e,randomColor:s,setChartOptions:l}=M(),a=h(!1),n=h({}),c=h([{id:"bar",name:"Sütun"},{id:"line",name:"Çizgi"},{id:"pie",name:"Pasta"}]),o=h({id:"bar",name:"Sütun"}),r=l(o.value),f=()=>{e("types").then(i=>{if(i){let u=s(i.data.length);n.value.labels=i.data.map(d=>d.name),n.value.datasets=[{label:"Tür / Kitap Sayısı",data:i.data.map(d=>d.books_count),backgroundColor:u,borderColor:"#000",borderWidth:1}],a.value=!0}})};return w(()=>{f()}),(i,u)=>(C(),G("div",null,[W(N,{class:"mb-4",label:"Grafik Türü",options:c.value,emptyOption:!1,modelValue:o.value.id,"onUpdate:modelValue":u[0]||(u[0]=d=>o.value.id=d)},null,8,["options","modelValue"]),Y("div",null,[a.value&&o.value.id=="bar"?(C(),O(m(tt),{key:0,data:n.value,options:m(r),style:{height:"75vh"}},null,8,["data","options"])):_("",!0),a.value&&o.value.id=="line"?(C(),O(m(et),{key:1,data:n.value,options:m(r),style:{height:"75vh"}},null,8,["data","options"])):_("",!0),a.value&&o.value.id=="pie"?(C(),O(m(at),{key:2,data:n.value,options:m(r),style:{height:"75vh"}},null,8,["data","options"])):_("",!0)])]))}};export{lt as default};
